<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}">

<th:block layout:fragment="css">
    <link rel="stylesheet" th:href="@{/css/item/item.css}">
</th:block>

<div layout:fragment="content">

    <div class="erp-card">

        <div class="card-header">
            <h2>ë¬¼í’ˆ ì¹´í…Œê³ ë¦¬ ê´€ë¦¬ (Category Management)</h2>
        </div>

        <table class="styled-table">
            <thead>
            <tr>
                <th style="width: 150px;">ì¹´í…Œê³ ë¦¬ ID</th>
                <th>ì¹´í…Œê³ ë¦¬ ëª…</th>
            </tr>
            </thead>
            <tbody>
            <tr th:if="${vo.isEmpty()}">
                <td colspan="2" style="text-align: center; padding: 30px;">
                    ë“±ë¡ëœ ì¹´í…Œê³ ë¦¬ê°€ ì—†ìŠµë‹ˆë‹¤.
                </td>
            </tr>

            <tr th:each="item : ${vo}">
                <td th:text="${item.icId}">IC_001</td>
                <td class="text-left">
                    <a th:href="@{/item/category(icId=${item.icId})}" class="category-link">
                        <span th:text="${item.category}">ì „ìì œí’ˆ</span>
                        <i class="material-icons arrow-icon">ğŸ‘‰</i>
                    </a>
                </td>
            </tr>
            </tbody>
        </table>

        <div class="bottom-actions">
            <button type="button" class="btn-create" onclick="openCreateModal()">
                ğŸ“‚ ì¹´í…Œê³ ë¦¬ ìƒì„±
            </button>
        </div>

    </div> <div id="createCategoryModal" class="modal-overlay hidden">
    <div class="modal-content" style="width: 400px;">

        <div class="modal-header">
            <h3>ìƒˆ ì¹´í…Œê³ ë¦¬ ìƒì„±</h3>
            <button type="button" class="close-btn" onclick="closeCreateModal()">&times;</button>
        </div>

        <div class="modal-body">
            <form th:action="@{/item/created_category}" method="post">

                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

                <div style="margin-bottom: 30px;">
                    <label class="form-label">ì¹´í…Œê³ ë¦¬ ëª…</label>
                    <input type="text" name="category" class="form-input"
                           placeholder="ì˜ˆ: ê°€ì „ì œí’ˆ" required autofocus>
                </div>

                <div class="modal-footer-actions">
                    <button type="button" class="btn-close" onclick="closeCreateModal()">ì·¨ì†Œ</button>
                    <button type="submit" class="btn-create-confirm">ë“±ë¡</button>
                </div>
            </form>
        </div>
    </div>
</div>

</div>

<th:block layout:fragment="script">
    <script>
        function openCreateModal() {
            document.getElementById('createCategoryModal').classList.remove('hidden');
            // ëª¨ë‹¬ ì—´ë¦¬ë©´ ì…ë ¥ì°½ì— í¬ì»¤ìŠ¤ (í¸ì˜ì„±)
            setTimeout(() => {
                document.querySelector('#createCategoryModal input[name="category"]').focus();
            }, 100);
        }

        function closeCreateModal() {
            document.getElementById('createCategoryModal').classList.add('hidden');
            // ì…ë ¥ì°½ ë¹„ìš°ê¸°
            document.querySelector('#createCategoryModal input[name="category"]').value = '';
        }

        // ë°°ê²½ í´ë¦­ ì‹œ ë‹«ê¸°
        document.getElementById('createCategoryModal').addEventListener('click', function(e) {
            if (e.target === this) closeCreateModal();
        });
    </script>
</th:block>
</html>